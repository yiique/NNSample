__author__ = 'liushuman'

import theano
import theano.tensor as T

a = T.vector()
b = T.vector()
c = T.scalar()
d = T.nnet.sigmoid(T.dot(a, b) + c)

fn = theano.function([a, b, c], d)

print fn([0, 0, 0, 1.0, 0, 0.2, 0, 0, 0, 0.3, 0.1, 0, 0, 0.4, 0.5, 0, 0, 0.9, 0.8, 0.7],
   [2.76465756e-01, 3.43354632e-01, 3.30654872e-01, 5.76647499e-01,
    4.03877957e-01, -7.25199827e-01, 1.64901758e-01, -4.79242408e-01,
   -7.20773939e-01, 8.91160922e-01, -8.15030150e-01, -7.39097510e-03,
    1.19250769e-01, -6.14597527e-01, 9.52727860e-01, -6.62963606e-03,
   -2.04311142e-01, -1.16485210e-01, -4.14933801e-01, -6.75223814e-01], 0.7219422)

e = a.reshape((20, 1))
fn2 = theano.function([a], e)
f = T.matrix()
g = f.reshape((1, 5))[0]
fn3 = theano.function([f], g)
print fn2([0, 0, 0, 1.0, 0, 0.2, 0, 0, 0, 0.3, 0.1, 0, 0, 0.4, 0.5, 0, 0, 0.9, 0.8, 0.7])
print fn3([[1], [2], [3], [4], [5]])